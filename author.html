<html>
<head>
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-114379663-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
<style>
.header{
	text-align:center;
	font: 40px "Trebuchet MS", Helvetica, sans-serif;
	color:dimgrey;
	margin:auto;
}

#title {
	font-family:calibri;
	font-style:bold;
	margin:auto;
}
</style>
<style class="embedly-css">
.art-bd-img{
	object-fit:cover;
	width:300px; 
	max-height:320px;
}

.resp-media{
	object-fit:cover;
	width:300px; 
	max-height:320px;
	padding-bottom:100% !important;
}

.reddit-self{
	text-overflow:ellipsis;
	overflow:hidden;
	width:100%; 
	max-height:320px
}

div.embedly-card{
	display:inline-block;
	vertical-align:top;
}
</style>

<script async src="https://embed.redditmedia.com/widgets/platform.js" charset="UTF-8"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript">
	
	authorData = $.ajax({
		url: "https://polandballdb.github.io/data/author_ids.json",
		dataType: "json",
		async: false
		}).responseJSON;
		
	flairData = $.ajax({
		url: "https://polandballdb.github.io/data/flair_ids.json",
		dataType: "json",
		async: false
		}).responseJSON;
	
	var authors = Object.keys(authorData);
	var authorsLower = authors.map(v => v.toLowerCase());
	
	function main() {	
		var input = document.getElementById("author").value.toLowerCase();
		if (authorsLower.includes(input)){
			for (const atr of authors){
				if (atr.toLowerCase() === input) {
					var comics = authorData[atr];
					document.getElementById("name").innerHTML = atr;
					
					var blockHTML = '';
					var ct = 0;
					for (var i = 0; i < comics.length; i++) {
						var id = comics[i];
						var flair = flairData[id];
						if (!(["redditormade","berndmade","repost","meta","collaboration"].includes(flair))||document.getElementById(flair).checked) {
							blockHTML += '<blockquote class="reddit-card" data-card-width="320px" data-card-preview="1"><a href="https://www.reddit.com/r/polandball/comments/'+id+'/"></a></blockquote>';
							ct++;
						}
					}
					
					document.getElementById("cards").innerHTML = blockHTML;
					document.getElementById("title").innerHTML = ct +' comics found';
					break;
				}
			}
		} else {
			document.getElementById("title").innerHTML = 'Invalid user';
			document.getElementById("cards").innerHTML = '';
			document.getElementById("name").innerHTML = 'Author';
		}
	}
	
	document.addEventListener("keyup", function(event) {
		if (event.keyCode === 13) {
			event.preventDefault();
			document.getElementById("search").click();
		}
	}); 
</script>
</head>
<body>


<div style="font-family:calibri;font-size:14px;">
<input type="text" id="author" autofocus>
<button onclick="main()" type="button" id="search">Search</button> 
<input type="checkbox" id="redditormade" checked>redditormade
<input type="checkbox" id="berndmade" checked>berndmade
<input type="checkbox" id="repost" checked>repost
<input type="checkbox" id="meta" checked>meta
<input type="checkbox" id="collaboration" checked>collaboration<br>
</div><p id="title">Author name</p>

<div>
<p class="header" id="name">Author</p><hr><div id="cards"></div>
</div>


</body>
</html>
